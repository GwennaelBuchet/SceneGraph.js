<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src\node\class.node.webview.js - cgSceneGraph</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.7.0&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.7.0&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/CGSGAnimationKey.html">CGSGAnimationKey</a></li>
            
                <li><a href="..&#x2F;classes/CGSGButtonMode.html">CGSGButtonMode</a></li>
            
                <li><a href="..&#x2F;classes/CGSGColor.html">CGSGColor</a></li>
            
                <li><a href="..&#x2F;classes/CGSGDimension.html">CGSGDimension</a></li>
            
                <li><a href="..&#x2F;classes/CGSGHandleBox.html">CGSGHandleBox</a></li>
            
                <li><a href="..&#x2F;classes/CGSGHashmap.html">CGSGHashmap</a></li>
            
                <li><a href="..&#x2F;classes/CGSGMath.html">CGSGMath</a></li>
            
                <li><a href="..&#x2F;classes/CGSGNode.html">CGSGNode</a></li>
            
                <li><a href="..&#x2F;classes/CGSGNodeButton.html">CGSGNodeButton</a></li>
            
                <li><a href="..&#x2F;classes/CGSGNodeCircle.html">CGSGNodeCircle</a></li>
            
                <li><a href="..&#x2F;classes/CGSGNodeColorPicker.html">CGSGNodeColorPicker</a></li>
            
                <li><a href="..&#x2F;classes/CGSGNodeEllipse.html">CGSGNodeEllipse</a></li>
            
                <li><a href="..&#x2F;classes/CGSGNodeImage.html">CGSGNodeImage</a></li>
            
                <li><a href="..&#x2F;classes/CGSGNodeSprite.html">CGSGNodeSprite</a></li>
            
                <li><a href="..&#x2F;classes/CGSGNodeSquare.html">CGSGNodeSquare</a></li>
            
                <li><a href="..&#x2F;classes/CGSGNodeTabMenu.html">CGSGNodeTabMenu</a></li>
            
                <li><a href="..&#x2F;classes/CGSGNodeText.html">CGSGNodeText</a></li>
            
                <li><a href="..&#x2F;classes/CGSGNodeWebview.html">CGSGNodeWebview</a></li>
            
                <li><a href="..&#x2F;classes/CGSGParticle.html">CGSGParticle</a></li>
            
                <li><a href="..&#x2F;classes/CGSGParticleEmitter.html">CGSGParticleEmitter</a></li>
            
                <li><a href="..&#x2F;classes/CGSGParticleSystem.html">CGSGParticleSystem</a></li>
            
                <li><a href="..&#x2F;classes/CGSGPickNodeMethod.html">CGSGPickNodeMethod</a></li>
            
                <li><a href="..&#x2F;classes/CGSGPosition.html">CGSGPosition</a></li>
            
                <li><a href="..&#x2F;classes/CGSGRegion.html">CGSGRegion</a></li>
            
                <li><a href="..&#x2F;classes/CGSGRotation.html">CGSGRotation</a></li>
            
                <li><a href="..&#x2F;classes/CGSGScale.html">CGSGScale</a></li>
            
                <li><a href="..&#x2F;classes/CGSGScene.html">CGSGScene</a></li>
            
                <li><a href="..&#x2F;classes/CGSGSceneGraph.html">CGSGSceneGraph</a></li>
            
                <li><a href="..&#x2F;classes/CGSGTimeline.html">CGSGTimeline</a></li>
            
                <li><a href="..&#x2F;classes/CGSGTraverser.html">CGSGTraverser</a></li>
            
                <li><a href="..&#x2F;classes/CGSGVector2D.html">CGSGVector2D</a></li>
            
                <li><a href="..&#x2F;classes/CGSGWEBVIEWMODE.html">CGSGWEBVIEWMODE</a></li>
            
                <li><a href="..&#x2F;classes/CGSGWrapMode.html">CGSGWrapMode</a></li>
            
                <li><a href="..&#x2F;classes/GLOBAL_CONSTANTS.html">GLOBAL_CONSTANTS</a></li>
            
                <li><a href="..&#x2F;classes/GLOBAL_METHODS.html">GLOBAL_METHODS</a></li>
            
                <li><a href="..&#x2F;classes/GLOBAL_PROPERTIES.html">GLOBAL_PROPERTIES</a></li>
            
                <li><a href="..&#x2F;classes/UTIL_ARRAY.html">UTIL_ARRAY</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/Animation.html">Animation</a></li>
            
                <li><a href="..&#x2F;modules/Math.html">Math</a></li>
            
                <li><a href="..&#x2F;modules/Node.html">Node</a></li>
            
                <li><a href="..&#x2F;modules/ParticleSystem.html">ParticleSystem</a></li>
            
                <li><a href="..&#x2F;modules/Scene.html">Scene</a></li>
            
                <li><a href="..&#x2F;modules/Util.html">Util</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src\node\class.node.webview.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;*
 * Copyright (c) 2012  Capgemini Technology Services (hereinafter “Capgemini”)
 *
 * License&#x2F;Terms of Use
 *
 * Permission is hereby granted, free of charge and for the term of intellectual property rights on the Software, to any
 * person obtaining a copy of this software and associated documentation files (the &quot;Software&quot;), to use, copy, modify
 * and propagate free of charge, anywhere in the world, all or part of the Software subject to the following mandatory conditions:
 *
 *   •    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 *
 *  Any failure to comply with the above shall automatically terminate the license and be construed as a breach of these
 *  Terms of Use causing significant harm to Capgemini.
 *
 *  THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
 *  WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON INFRINGEMENT. IN NO EVENT SHALL THE AUTHORS
 *  OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
 *  TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 *  Except as contained in this notice, the name of Capgemini shall not be used in advertising or otherwise to promote
 *  the use or other dealings in this Software without prior written authorization from Capgemini.
 *
 *  These Terms of Use are subject to French law.
 *&#x2F;

&#x2F;**
 * The different rendering mode
 * @class CGSGWEBVIEWMODE
 * @type {Object}
 * @author Gwennael Buchet (gwennael.buchet@gmail.com)
 *&#x2F;
var CGSGWEBVIEWMODE = {
	&#x2F;**
	 * @property LIVE
	 *&#x2F;
	LIVE   : 0,
	&#x2F;**
	 * @property PREVIEW
	 *&#x2F;
	PREVIEW: 1
};

&#x2F;*
 * TODO :
 * - When resize or drag : switch to PREVIEW mode to allow mouse over the webview
 * - load a page in AJAX and make an image from it to assign to the PREVIEW mode
 *&#x2F;

&quot;use strict&quot;;

&#x2F;**
 * @class CGSGNodeWebview
 * @module Node
 * @extends CGSGNode
 * @constructor
 * @param {Number} x Relative position on X
 * @param {Number} y Relative position on X
 * @param {Number} width Relative dimension
 * @param {Number} height Relative Dimension
 * @param {String} url URL of the webpage
 * @type {CGSGNodeWebview}
 *&#x2F;
var CGSGNodeWebview = CGSGNode.extend(
	{
		initialize: function (x, y, width, height, url) {
			this._super(x, y, CGSGMath.fixedPoint(width), CGSGMath.fixedPoint(height));

			&#x2F;**
			 * Size of the area around the webview in LIVE mode
			 * @property threshold
			 * @default 20
			 * @type {Number}
			 *&#x2F;
			this.threshold = 20;
			&#x2F;**
			 * Color of the area around the webview in LIVE mode
			 * @property color
			 * @default &quot;lightGray&quot;
			 * @type {String}
			 *&#x2F;
			this.color = &quot;lightGray&quot;;
			&#x2F;**
			 * Color of line around the webview in LIVE mode
			 * @property color
			 * @default &quot;Gray&quot;
			 * @type {String}
			 *&#x2F;
			this.lineColor = &quot;Gray&quot;;

			&#x2F;**
			 * @property classType
			 * @type {String}
			 *&#x2F;
			this.classType = &quot;CGSGNodeWebview&quot;;

			&#x2F;**
			 * A HTML tag that contains the web view : an iframe
			 * @property _liveContainer
			 * @type {HTMLElement}
			 * @private
			 *&#x2F;
			this._liveContainer = null;

			&#x2F;**
			 * A CGSGNodeImage rendering the preview of the webpage
			 * @property _previewContainer
			 * @type {CGSGNodeImage}
			 * @private
			 *&#x2F;
			this._previewContainer = null;

			&#x2F;**
			 * URL of the web page
			 * @property _url
			 * @type {String}
			 * @private
			 *&#x2F;
			this._url = url;

			&#x2F;**
			 * URL for the preview mode
			 * @property _previewURL
			 * @private
			 * @type {String}
			 *&#x2F;
			this._previewURL = null;

			this._createLiveContainer();
			this._createPreviewContainer();

			this.switchMode(CGSGWEBVIEWMODE.LIVE);
		},

		&#x2F;**
		 * Initialize and add the live container to the HTML body
		 * @method _initLiveContainer
		 * @private
		 *&#x2F;
		_initLiveContainer: function () {
			if (!cgsgExist(this._liveContainer)) {
				this._createLiveContainer();
			}

			document.body.appendChild(this._liveContainer);
		},

		&#x2F;**
		 * Initialize and add the CGSGNodeImage
		 * @method _initPreviewContainer
		 * @private
		 *&#x2F;
		_initPreviewContainer: function () {
			if (!cgsgExist(this._previewContainer)) {
				this._createPreviewContainer();
			}

			this.addChild(this._previewContainer);

			&#x2F;&#x2F;load the webcontent via Ajax
			&#x2F;&#x2F;this._loadPageAsync();
		},

		&#x2F;**
		 * Create an IFRAME tag in the _liveContainer property
		 * @method _createLiveContainer
		 * @private
		 *&#x2F;
		_createLiveContainer: function () {
			var uri = &quot;&quot;;
			if (cgsgExist(this._url)) {
				uri = this._url;
			}

			this._liveContainer = document.createElement(&quot;IFRAME&quot;);

			this._liveContainer.style.position = &quot;absolute&quot;;
			this._liveContainer.setAttribute(&quot;src&quot;, uri);
		},

		&#x2F;**
		 * Create the CGSGNodeImage to contain the preview
		 * @method _createPreviewContainer
		 * @private
		 *&#x2F;
		_createPreviewContainer: function () {
			this._previewContainer =
			new CGSGNodeImage(0, 0, this._previewURL);

			this._previewContainer.isTraversable = false;
		},

		&#x2F;*
		 *
		 * @private
		 * @method _loadPageAsync
		 *&#x2F;
		&#x2F;*_loadPageAsync : function () {

		 },*&#x2F;

		&#x2F;**
		 * @method setURL
		 * @param {String} url
		 *&#x2F;
		setURL: function (url) {
			this._url = url;

			if (cgsgExist(this._liveContainer)) {
				this._liveContainer.setAttribute(&quot;src&quot;, this._url);
			}
		},

		&#x2F;**
		 * Get a String representing the URL
		 * @method getURL
		 * @return {string}
		 *&#x2F;
		getURL: function () {
			return this._url;
		},

		&#x2F;**
		 * Set the URL of the image for the preview mode (CGSGWEBVIEWMODE.PREVIEW)
		 * @method setPreviewURL
		 * @param {String} imageURL
		 *&#x2F;
		setPreviewURL: function (imageURL) {
			this._previewURL = imageURL;
			this._previewContainer.setURL(this._previewURL);
		},

		&#x2F;**
		 * Switch between rendering mode
		 * @method switchMode
		 * @param {Number} mode a CGSGWEBVIEWMODE enum : LIVE or PREVIEW
		 *&#x2F;
		switchMode: function (mode) {
			if (mode === CGSGWEBVIEWMODE.LIVE) {
				this.detachChild(this._previewContainer);
				this._initLiveContainer();
			}
			else {
				&#x2F;&#x2F;Initially, there is no mode, so we cannot remove the child from the Body
				if (this._mode === CGSGWEBVIEWMODE.LIVE) {
					document.body.removeChild(this._liveContainer);
				}
				this._initPreviewContainer();
			}

			this._mode = mode;
		},

		&#x2F;**
		 * @method getCurrentMode
		 * @return {CGSGWEBVIEWMODE} the current mode
		 *&#x2F;
		getCurrentMode: function () {
			return this._mode;
		},

		&#x2F;**
		 * @protected
		 * @method render
		 * Custom rendering
		 * *&#x2F;
		render: function (context) {
			&#x2F;&#x2F;save current state
			this.beforeRender(context);

			context.globalAlpha = this.globalAlpha;

			if (this._mode === CGSGWEBVIEWMODE.LIVE) {
				context.fillStyle = this.color;
				context.strokeStyle = this.lineColor;
				context.lineWidth = this.lineWidth;

				&#x2F;&#x2F;we draw the rect at (0,0) because we have already translated the context to the correct position
				context.fillRect(0, 0, this.dimension.width, this.dimension.height);

				context.strokeRect(0, 0, this.dimension.width, this.dimension.height);

				context.strokeRect(this.threshold - 2, this.threshold - 2,
								   8 + this.dimension.width - this.threshold * 2,
								   8 + this.dimension.height - this.threshold * 2);

				if (cgsgExist(this._liveContainer)) {
					this._liveContainer.style.left = (this.getAbsoluteLeft() + this.threshold) + &quot;px&quot;;
					this._liveContainer.style.top = (this.getAbsoluteTop() + this.threshold) + &quot;px&quot;;
					this._liveContainer.style.width = (this.getAbsoluteWidth() - this.threshold * 2) + &quot;px&quot;;
					this._liveContainer.style.height = (this.getAbsoluteHeight() - this.threshold * 2) + &quot;px&quot;;
				}
			}
			else {
				this._previewContainer.resizeTo(this.getWidth(), this.getHeight());

				&#x2F;&#x2F;draw this zone
				context.fillStyle = this.color;

				&#x2F;&#x2F;we draw the rect at (0,0) because we have already translated the context to the correct position
				context.fillRect(0, 0, this.getWidth(), this.getHeight());
			}

			&#x2F;&#x2F;restore state
			this.afterRender(context);
		},

		&#x2F;**
		 * Free the memory taken by this node
		 * @method free
		 *&#x2F;
		free: function () {
			if (cgsgExist(this._liveContainer)) {
				cgsgCanvas.removeChild(this._liveContainer);
				delete (this._liveContainer);
			}

			this._super();
		},

		&#x2F;**
		 * Return the copy of this node
		 * @method copy
		 * @return {CGSGNodeWebview}
		 *&#x2F;
		copy: function () {
			var node = new CGSGNodeWebview(this.position.x, this.position.y, this.dimension.width,
										   this.dimension.height, this.url);
			&#x2F;&#x2F;call the super method
			node = this._super(node);

			node.threshold = this.threshold;
			node.color = this.color;
			node.lineColor = this.lineColor;

			node.switchMode(this.mode);

			return node;
		}
	}
);

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
