<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>cgSceneGraph</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="title" content="HTML5 canvas framework"/>
    <meta name="description" content="html5 canvas framework"/>
    <meta name="keywords" content="html5 canvas cgscenegraph cgSceneGraph framework html 5"/>
    <meta name="language" content="en"/>
    <meta name="subject" content="html 5 canvas framework"/>
    <meta name="robots" content="All"/>
    <meta name="copyright" content="Capgemini industries et Distribution"/>
    <meta name="abstract" content=" html 5 canvas framework"/>
    <meta name="MSSmartTagsPreventParsing" content="true"/>

    <link rel="fluid-icon" href="http://gwennaelbuchet.github.com/cgSceneGraph/fluidicon.png" title="cgSceneGraph"/>
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../apple-touch-icon-114.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../apple-touch-icon-114.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../apple-touch-icon-144.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../apple-touch-icon-144.png"/>

    <link rel="icon" type="image/png" href="../favicon.png"/>

    <link href="../css/shCore.css" rel="stylesheet" type="text/css"/>
    <link href="../css/shThemeDefault.css" rel="stylesheet" type="text/css"/>
    <script src="../js/shCore.js" type="text/javascript"></script>
    <script src="../js/shBrushJScript.js" type="text/javascript"></script>

    <link href='http://fonts.googleapis.com/css?family=Signika' rel='stylesheet' type='text/css'>
    <link id="theme" rel="stylesheet" type="text/css" href="../css/style.css" title="theme"/>

    <script src="../js/cufon-yui.js" type="text/javascript"></script>
    <script src="../js/Aller.font.js" type="text/javascript"></script>
    <script type="text/javascript">
        Cufon.replace('ul.oe_menu div a', {hover: true});
        Cufon.replace('h1,h2,.oe_heading');
    </script>

</head>
<body>
<!-- top wrapper -->
<div id="topWrapper">
    <div id="topBanner">
      <span class="downloadLink">
            <a href="https://github.com/GwennaelBuchet/cgSceneGraph/zipball/master"
               title="Download latest version as a Zip file">
                <img src="../img/dlzip.png" width="60"/>
            </a>
            <a href="https://github.com/GwennaelBuchet/cgSceneGraph/tarball/master"
               title="Download latest version as a tar.gz file">
                <img src="../img/dltar.png" width="60"/>
            </a>
             <a href="https://github.com/GwennaelBuchet/cgSceneGraph"
                title="Fork me on GitHub"
                target="_blank"><img src="../img/blacktocat.png" width="50"/></a>
        </span>
    </div>
    <!-- end topBanner -->
</div>
<!-- end top wrapper -->

<div id="topnav">
    <div class="oe_wrapper">
        <!--div id="oe_overlay" class="oe_overlay"></div-->
        <ul id="oe_menu" class="oe_menu">
            <li>
                <a href="../index.html" shape="rect">HOME</a>
            </li>
            <li class="current" style="border:none"><a href="../tutorials.html">TUTORIALS</a>

                <div style="left:-112px;">
                    <ul>
                        <li class="oe_heading">Starter</li>
                        <li><a href="../tutorials.html">Global concepts</a></li>
                        <li><a href="simple_project.html">Create a simple project</a></li>
                        <li><a href="custom_node.html">Create your nodes</a></li>
                        <li><a href="srt_animations.html">SRT Animations</a></li>
                        <li><a href="multiselection.html">Multi-selection</a></li>
                        <li><a href="image_sharing.html">Sprite sheets / Image sharing</a></li>
                        <li><a href="spritesheets.html">SpriteSheets</a></li>
                        <li><a href="traverser.html">Traverse the graph</a></li>
                    </ul>
                    <ul>
                        <li class="oe_heading">Events</li>
                        <li><a href="node_events.html">Node events</a></li>
                        <li><a href="scene_events.html">Scene events</a></li>
                        <li><a href="animation_events.html">Animation events</a></li>
                    </ul>
                    <ul>
                        <li class="oe_heading"><br/>Advanced</li>
                        <li><a href="particles.html">Particles</a></li>
                        <li><a href="share_animation.html">Share animation values</a></li>
                        <li><a href="advanced_animation.html">Advanced animation</a></li>
                        <li><a href="making_game.html">Develop a game</a></li>
                    </ul>
                    <ul>
                        <li class="oe_heading">Tips & Tricks</li>
                        <li><a href="prerendering.html">Pre-rendering</a></li>
                        <li><a href="fullscreen.html">How-To: Fullscreen size</a></li>
                    </ul>
                </div>
            </li>
            <li>
                <a href="../examples.html" shape="rect">EXAMPLES</a>
            </li>
            <li>
                <a href="../ecosystem.html" shape="rect">ECOSYSTEM</a>
            </li>
            <li>
                <a href="../api.html" shape="rect">API DOCS</a>
            </li>
            <li>
                <a href="../changelog.html" shape="rect">CHANGE-LOG</a>
            </li>
            <li>
                <a href="../comments.html" shape="rect">FORUMS</a>
            </li>
            <li>
                <a href="../about.html" shape="rect">ABOUT</a>
            </li>
        </ul>
    </div>

</div>
<!-- end topnav -->


<div id="wrapper">
    <div id="bg">
        <div id="header"></div>
        <div id="page">
            <!-- begin container -->
            <div id="container">
                <!--  content -->
                <div id="content">
                    <div id="center">

                        <h1>Image Sharing / Sprite sheet</h1>

                        <br/>

                        <h2>Concept of a sprite sheet</h2>

                        <p>It's very useful to store several pictures on 1 image file: it saves loading time,
                            requests to the HTTP server and may be memory usage.<br/><br/>
                            The aim is so to use 1 single image file to store all your sprites. Such a file is called a
                            sprite sheet.<br/>

                            <br/><br/>
                            Example of image:<br/>
                            <img src="../img/board.png" alt="sprite sheet image" class="imgCenter"/>
                            <br/>
                            The question now is: How to use this single image file in several image nodes ?
                        </p>

                        <br/>
                        <hr/>
                        <h2>How to use sprite sheets</h2>

                        <p>
                            To use sprite sheet is done in 3 steps:
                        <ul>
                            <li>Load the image</li>
                            <li>Dispatch the image to the nodes (CGSGNodeImage, CGSGNodeSprite, ...)</li>
                            <li>Each node using the image should slice it to only use the needed region</li>
                        </ul>
                        <br/>

                        <h3>Load the image</h3>

                        <p>
                            To load an image is achieved in Javascript:

                        <div class="displayCode">
                                <pre class="brush: js;">
            //load the image normally, like in any JS context
			this.img = new Image();
            //specify which function to call when the image will be loaded
			this.img.onload = this.onImageLoaded.bind(this);
            //start the loading
			this.img.src = "images/board.png";
                                    </pre>
                        </div>

                        </p>
                        <br/>

                        <h3>Dispatch the image</h3>

                        <p>
                            Once the image is loaded, you can send it to every node you need.<br/><br/>
                            The CGSGNodeImage and CGSGNodeSprite classes provide a "setImage(img)" method.<br/>
                            So, when the image is loaded, just call this method with the image in parameter:

                        <div class="displayCode">
                                <pre class="brush: js;">
            /**
             * Fired when the image loading is complete.
             * Set the image object (img) to our image nodes
             */
            onImageLoaded: function () {
                this.imgNode1.setImage(this.img);
                this.imgNode2.setImage(this.img);
            }
                                    </pre>
                        </div>
                        <br/>
                        As we will set the image to the image Nodes after the initialization, we don't have to specify an image URL on the CGSGNodeImage constructor:

                        <div class="displayCode">
                                <pre class="brush: js;">
                this.imgNode1 = new CGSGNodeImage(
                    90, //x
                    40, //y
                    null); // no url. no need to load image now
                                    </pre>
                        </div>
                        </p>
                        <br/>

                        <h3>Slice the image</h3>

                        <p>
                            Well, now we have a single image and have pushed it to our nodes.<br/>
                            That's a good start: we have consumed few bandwidth of the network and low memory.
                            However we still need to slice the image in the nodes, to use only the region it needs.<br/>
                        <h4>What is a slice ?</h4>
                        A slice is a piece of the image, i.e. the small region from the original image to render.
                        <br/>
                        In the following example, we slice the snow man from slice position = [429, 23] and a slice
                        dimension of [23, 23]:
                        <br/>
                        <br/>
                        <img src="../img/slice.png" alt="slice" class="imgCenter"/>

                        <br/><br/>
                        That can be applied on a CGSGNodeImage instance with the "setSlice" method of the class:
                        <div class="displayCode">
                                <pre class="brush: js;">
                           /**
                            * Set the slice into the image
                            * @method setSlice
                            * @param {Number} x position X of the slice in the image
                            * @param {Number} y position Y of the slice in the image
                            * @param {Number} w width of the slice
                            * @param {Number} h height of the slice
                            * @param {Boolean} updateDimension If true, the dimension will be set with the dimension of the slice
                            */
                           setSlice: function (x, y, w, h, updateDimension);
                                    </pre>
                        </div>
                        For animated sprites (CGSGNodeSprite class), the slices are defined with the "addAnimation"
                        method.<br/>

                        <div class="displayCode">
                                <pre class="brush: js;">
                            /**
                             * Add an animation for this sprite
                             * @public
                             * @method addAnimation
                             * @param {String} name Name for this animation
                             * @param {Number} speed Number of frames between 2 steps
                             * @param {Number} frames Number of frame for this animation
                             * @param {Number} sliceX slice position inside the image for this animation
                             * @param {Number} sliceY slice position inside the image for this animation
                             * @param {Number} width width of 1 frame
                             * @param {Number} height height of 1 frame
                             * @param {Number} framesPerLine Number of frames per line in the image
                             */
                            addAnimation: function (name, speed, frames, sliceX, sliceY, width, height, framesPerLine);
                                    </pre>
                        </div>

                        <br/><br/>
                        So, to slice the snow man from our sprite sheet to the "this.imgNode1" node we just define the
                        region of the slice in the image:
                        <div class="displayCode">
                                <pre class="brush: js;">
                                    //x, y, width, height, must recompute dimension
                                    this.imgNode1.setSlice(429, 23, 23, 23, true);
                                </pre>
                        </div>
                        If the last parameter of the "setSlice" method seems weird to you, just put "true" as value and
                        it will always be ok :)

                        </p>

                        </p>

                        <br/>
                        <hr/>
                        <h2>Full example</h2>

                        <p>
                            Here is a complete example of code :
                            <br/>

                        <div class="displayCode">
                                <pre class="brush: js;">
    var CGMain = CGSGScene.extend(
	{
		initialize: function (canvas) {

			//call the constructor of the parent class (ie : CGSGScene)
			this._super(canvas);

			////// INITIALIZATION /////////

			this.initializeCanvas();
			this.createScene();

			this.startPlaying();
		},

		initializeCanvas: function () {
			//resize the dimension of the canvas to fulfill the viewport
			this.viewDimension = cgsgGetRealViewportDimension();
			this.setCanvasDimension(this.viewDimension);
		},

		/**
		 * Just create a single node (an image node)
		 */
		createScene: function () {

			this.isDragSelectEnabled = true;

			//first, create a root node
			this.rootNode = new CGSGNode(0, 0, 1, 1);
			this.sceneGraph.addNode(this.rootNode, null);

			//second, create the 2 nodes, with no image URL, and add them to the root node
			this.imgNode1 = new CGSGNodeImage(
				40, //x
				40, //y
                null); // no url. no need to load image now

			//cut the slice from the source image
			this.imgNode1.setSlice(476, 0, 34, 34, true);

			//add some attributes
			this.imgNode1.isResizable = true;
			this.imgNode1.isDraggable = true;

			//add image node to the root of the scenegraph
			this.rootNode.addChild(this.imgNode1);

			this.imgNode2 = new CGSGNodeImage(
				90, //x
				40, //y
                null); // no url. no need to load image now

			//add some attributes
			this.imgNode2.isResizable = true;
			this.imgNode2.isDraggable = true;
			this.rootNode.addChild(this.imgNode2);
			//cut the slice from the source image
			this.imgNode2.setSlice(612, 34, 34, 34, true);

			//then load the image normally, like in any JS context
			this.img = new Image();
			this.img.onload = this.onImageLoaded.bind(this);
			this.img.src = "images/board.png";
		},

		/**
		 * Fired when the image loading is complete.
		 * Set the image object (img) to our image nodes
		 */
		onImageLoaded: function () {
			this.imgNode1.setImage(this.img);
			this.imgNode2.setImage(this.img);
		}
	}
);
                                </pre>
                        </div>
                        </p>
                        <p>
                    </div>

                    <div class="clear" style="height:4px"></div>
                </div>
                <!-- end content -->
            </div>
            <!-- end container -->
        </div>

        <div id="pageFooter">
        </div>
    </div>
</div>
<!-- end wrapper -->
<div class="footerShadow"></div>

<div id="footerWrapper">
    <div id="footerBanner">
        <div class="footerBlock alignleft">
            <h2>WHAT'S UP?</h2>
            <hr/>
            <h4>cgSceneGraph v1.4.2</h4>
            New Nodes, even faster, more interactions, ... <span class="blueText">cgSceneGraph v1.4.2</span> is released
            :)<br/>
            Please, send us your feedback and requests on <a href="https://github.com/GwennaelBuchet/cgSceneGraph"
                                                             target="_blank">GitHub</a>
        </div>

        <div class="footerBlock alignright logoCap">
            <h2>CONTACT</h2>

            <p>
                mail to: <a href="mailto:gwennael.buchet@capgemini.com" title="gwennael.buchet@capgemini.com">gwennael.buchet@capgemini.com</a><br/>

            <p/>
        </div>

        <div class="clear" style="height:4px"></div>
    </div>
</div>


<script type="text/javascript" src="../js/jquery-1.8.2.min.js"></script>
<script type="text/javascript">
    $(function () {
        var $oe_menu = $('#oe_menu');
        var $oe_menu_items = $oe_menu.children('li');

        $oe_menu_items.bind('mouseenter',function () {
            var $this = $(this);
            $this.addClass('slided selected');
            $this.children('div').css('z-index', '9999').stop(true, true).slideDown(200, function () {
                $oe_menu_items.not('.slided').children('div').hide();
                $this.removeClass('slided');
            });
        }).bind('mouseleave', function () {
                    var $this = $(this);
                    $this.removeClass('selected').children('div').css('z-index', '1');
                    $oe_menu_items.children('div').hide();
                });

        $oe_menu.bind('mouseenter',function () {
            var $this = $(this);
        }).bind('mouseleave', function () {
                    var $this = $(this);
                    $this.removeClass('hovered');
                    $oe_menu_items.children('div').hide();
                })
    });
</script>
<script type="text/javascript">
    SyntaxHighlighter.all()
</script>
</body>
</html>
