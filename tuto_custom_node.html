<!DOCTYPE html><!--[if IE 8]>
<html class="ie ie8"> <![endif]--><!--[if IE 9]>
<html class="ie ie9"> <![endif]--><!--[if gt IE 9]><!-->
<html> <!--<![endif]-->
<head>
    <meta charset="utf-8"/>
    <title>SceneGraph.js</title>
    <meta name="keywords" content="HTML5,canvas,animation,framework"/>
    <meta name="description" content="HTML5 interactive and animation framework"/>
    <meta name="Author" content="Gwennael Buchet [gwennael.buchet@gmail.com]"/>

    <!-- mobile settings -->
    <meta name="viewport" content="width=device-width, maximum-scale=1, initial-scale=1, user-scalable=0"/>

    <link rel="fluid-icon" href="http://gwennaelbuchet.github.com/{{project.name}}/fluidicon.png"
          title="{{project.name}}"/>
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="apple-touch-icon-114.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="apple-touch-icon-114.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="apple-touch-icon-144.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="apple-touch-icon-144.png"/>

    <link rel="icon" type="image/png" href="favicon.png"/>

    <!-- WEB FONTS -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700,800" rel="stylesheet" type="text/css"/>

    <!-- CORE CSS -->
    <link href="assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/font-awesome.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/animate.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/superslides.css" rel="stylesheet" type="text/css"/>

    <!-- THEME CSS -->
    <link href="assets/css/essentials.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/layout.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/layout-responsive.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/color_scheme/green.css" rel="stylesheet" type="text/css"/>

    <link href="assets/css/shCore.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/shThemeDefault.css" rel="stylesheet" type="text/css"/>
    <script src="js/shCore.js" type="text/javascript"></script>
    <script src="js/shBrushXml.js" type="text/javascript"></script>
    <script src="js/shBrushJScript.js" type="text/javascript"></script>


    <!-- modernizr -->
    <script type="text/javascript" src="assets/plugins/modernizr.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.0-beta.5/angular.min.js"></script>
    <script src="js/app.js"></script>

</head>
<body ng-app="cgsgApp">
<!-- Available classes for body: boxed , pattern1...pattern10 . Background Image - example add: data-background="assets/images/boxed_background/1.jpg"  -->

<!-- TOP NAV -->
<ng-include src="'partials/header.html'"></ng-include>
<!-- /TOP NAV -->

<!-- WRAPPER -->
<div id="wrapper" ng-controller="MainCtrl">

<!-- PAGE TITLE -->
<header id="page-title">
    <div class="container">
        <h1>Tutorials</h1>

        <ul class="breadcrumb">
            <li><a href="index.html">Home</a></li>
            <li><a href="tutorials.html">Tutorials</a></li>
            <li class="active">Custom Nodes</li>
        </ul>
    </div>
</header>


<div class="row">

<div id="side-nav" class="col-md-3 hidden-xs hidden-sm hidden-print">
    <ul class="nav nav-pills nav-stacked affix" data-offset-top="60" data-offset-bottom="800">
        <li class="active"><a href="#intro">Introduction</a></li>
        <li><a href="#cgsgnode">What is CGSGNode</a></li>
        <li><a href="#extend">How to extend</a></li>
        <li><a href="#use">How to use your extension</a></li>
        <li><a href="#advance">Full example</a></li>
    </ul>
</div>

<div class="col-xs-12 col-sm-12 col-md-9">

<div id="intro">
    <h1>Introduction</h1>

    <p>The power of the framework is in its design: <br/>
        <strong class="alert">{{project.name}} does not render anything by itself, but provides a
            framework and a lot of features to help you rendering what you need !</strong>
        <br/>
        <br/>
        That's the big difference with other tools: you won't never be limited to what the
        framework provides !<br/>
        Of course, there are a lot of cool and useful <a href="examples.html" target="_blank">already
            existing extensions</a>, and you can build
        complete games and applications just with them:
    <ul>
        <li>image</li>
        <li>animated sprites</li>
        <li>button</li>
        <li>webview</li>
        <li>particle system</li>
        <li>text</li>
        <li>square, circle, ellipse, line, polygon, ...</li>
        <li>tab menu</li>
        <li>color picker</li>
        <li>&hellip;</li>
    </ul>

    Anyway, you will probably need to create your own node, so lets see how to do it.
    </p>

</div>
<hr/>
<div id="cgsgnode">
    <h2>What is the CGSGNode class ?</h2>

    <p>The CGSGNode class is the base class for any displayed items on the screen. <br/>
        Everything in the graph is a CGSGNode or inherit from it (ie: is an extension):<br/>

    <p class="text-center">
        <img src="assets/images/tuto/concepts_graph.png" alt="graph of nodes" class="imgCenter"/>
    </p>

    The CGSGNode class encapsulates a lot of properties and methods, including a "render"
    method. This one doesn't do anything, it has to be overrided by inherited classes.<br/>
    Here is a non-exhaustive list of properties and methods that a custom node (also called "extension" or
    "plugin") will inherit.

    <p>

    <h4>Main properties of CGSGNode:</h4>
    <ul>
        <li>isDraggable</li>
        <li>isResizable</li>
        <li>isVisible</li>
        <li>isTraversable</li>
        <li>globalAlpha</li>
        <li>bkColors[]</li>
        <li>name</li>
        <li>isSelected (read only)</li>
        <li>rotationCenter</li>
        <li>position (read only)</li>
        <li>dimension (read only)</li>
        <li>scale (read only)</li>
        <li>rotation (read only)</li>
        <li>onClick</li>
        <li>onDblClick</li>
        <li>onDrag</li>
        <li>onDragEnd</li>
        <li>onResize</li>
        <li>onResizeEnd</li>
        <li>onSelect</li>
        <li>onDeselect</li>
        <li>&hellip;</li>
    </ul>

    <h4>Main methods of CGSGNode:</h4>
    <ul>
        <li>render (context)</li>
        <li>setSelected (isSelected)</li>
        <li>pickNode (mousePosition, absoluteScale, ghostContext, recursively, condition)</li>
        <li>translateTo, translateWith, translateBy</li>
        <li>resizeTo, resizeWith, resizeBy</li>
        <li>scaleTo, scaleWith, scaleBy</li>
        <li>rotateTo, rotateWith, rotateBy</li>
        <li>addChild (newNode)</li>
        <li>addChildAt (newNode, index)</li>
        <li>removeChild (node, searchRecursively)</li>
        <li>detachChildAt (index)</li>
        <li>detachChild (childNode)</li>
        <li>setRegionConstraint (region)</li>
        <li>getAbsolutePosition ()</li>
        <li>getAbsoluteScale ()</li>
        <li>getAbsoluteRotation ()li>
        <li>getAbsoluteLeft, getAbsoluteRight, getAbsoluteTop, getAbsoluteBottom, getAbsoluteWidth,
            getAbsoluteHeight
        </li>
        <li>getWidth, getHeight</li>
        <li>isColliding, getListOfCollidingBrothers, isCollidingABrother</li>
        <li>&hellip;</li>
    </ul>
    </p>
    </p>
</div>
<hr/>
<div id="extend">
    <h2>How to extend the CGSGNode class ?</h2>

    <p>
        {{project.name}} is an OOP tool, so to inherit from CGSGNode, a class has to extend
        CGSGNode.<br/>
        This is done simply like this:

    <div class="displayCode">
                                <pre class="brush: js;">
var CustomNode = CGSGNode.extend(
    {
        //constructor.
        // You can specify any parameters you need
        initialize : function(x, y, width, height) {
            //CGSGNode constructor takes only 2 parameters: x & y
			this._super(x, y);

            //resize your node if needed
			this.resizeTo(width, height);

			/**
			 * @property classType
			 * @readonly
			 * @type {String}
			 */
			this.classType = "CustomNode";

            //add all other attributes you need
            ...
		},

        /**
         * Custom rendering.
         * You must define this method and declare inside what is the rendering loop
         *  for this node.
         * Here we will just draw a square
         * @method render
         * @override
         * @protected
         * @param {CanvasRenderingContext2D} context the context into render the node
         * */
        render:function (ctx) {
			/**
             * Set color for this zone.
             * Colors are managed with CSS and are stored into "this.bkgcolors" attribute, which is an array.
             * Following lines are already managed by the framework and are set here just as an example.
             */
			//ctx.globalAlpha = this.globalAlpha;
            //if (!cgsgExist(this.bkgcolors[1])) {
            //    ctx.fillStyle = this.bkgcolors[0];
            //}
            //else {
            //    var gradient = ctx.createLinearGradient(0, 0, 0, this.dimension.height);
            //    for (var i = 0, len = this.bkgcolors.length ; i < len ; i++)
            //        gradient.addColorStop(i, this.bkgcolors[i]);
            //    ctx.fillStyle = gradient;
            //}
            //
            //if (this.lineWidth > 0) {
            //    ctx.strokeStyle = this.lineColor;
            //    ctx.lineWidth = this.lineWidth;
            //}
            //
            //this._applyShadow(ctx);

            //we draw the rect at (0,0) because the framework has already translated the context
            // to the correct position
            ctx.fillRect(0, 0, this.dimension.width, this.dimension.height);

        },

        /**
         * Return a copy of this node
         * @method copy
         * @override
         * @return {CGSGNodeSquare} a copy of this node
         */
        copy:function () {
            var node = new CustomNode(this.position.x, this.position.y,
                                      this.dimension.width, this.dimension.height);
            //call the super method
            node = this._super(node);

            return node;
        }
    }
);
                                </pre>
    </div>
    </p>
</div>
<hr/>
<div id="use">
    <h2>How to use your extension</h2>

    <p>
        Use your node as you use any node: by instanciating it :)<br/>

        Example:

    <div class="displayCode">
                                <pre class="brush: js;">
        createScene : function () {
            //first, define an arbitrary node as root node
            var rootNode = new CGSGNode(0, 0, 0, 0);
            this.sceneGraph.addNode(rootNode, null);

			//X, Y, WIDTH, HEIGHT
			var square = new CustomNode(20, 20, 150, 150);

            //you can use CGSGNode properties
			square.isDraggable = true;
			square.isResizable = true;
			square.globalAlpha = 0.8;

            //custom your node by overriding CSS declaration
			square.bkgcolors[0] = "lightgray";

            //add your square as child of the root node
			rootNode.addChild(square);

            //instanciate a second CustomNode
			var square2 = new CustomNode(200, 200, 20, 35);
            rootNode.addChild(square2);
		}
                                </pre>
    </div>
    </p>
</div>
<hr/>
<div id="advance">
    <h2>Full example : A "sky" node</h2>

    <p>
    A sky node is a good example, I think: complete, easy to understand and easy to extend to learn by yourself :)

    <div class="displayCode">
        <pre class="brush: js;">
            var SkyNode = CGSGNode.extend({
                initialize: function () {
                    this._super(0, 0);
                    //resize to full screen
                    this.resizeTo(CGSG.canvas.width, CGSG.canvas.height);

                    //we may want to add a yellow sun. Just add a yellow circle :)
                    var sun = new Circle(100, 100, 30); // centerX, centerY, radius
                    this.addChild(sun);

                    //add a bit of optimization by avoiding useless event on it
                    this.isTraversable = false;
                    // because we won't never modify the display of our node, put it in cache
                    this.setPrecomputed(true);
                },

                render: function (context) {
                    // a sky is a gradient from blue (top) to white (bottom)
                    var gradient = context.createLinearGradient(0, 0, 0, this.dimension.height);
                    gradient.addColorStop(0, "#48A9FF");
                    gradient.addColorStop(1, "#FFFFFF");
                    context.fillStyle = gradient;
                    //if we use CSS, we may just remove the 4 lines above and just declare CSS style something like:
                    //CSS file:
                    //.sky {
                    //    background: -webkit-linear-gradient(#FFFFFF, #48A9FF); /* For Safari */
                    //    background: -o-linear-gradient(#FFFFFF, #48A9FF); /* For Opera 11.1 to 12.0 */
                    //    background: -moz-linear-gradient(#FFFFFF, #48A9FF); /* For Firefox 3.6 to 15 */
                    //    background: linear-gradient(#FFFFFF, #48A9FF); /* Standard syntax */
                    //}
                    //
                    // main.js file:
                    //skyNode.setClass("sky");

                    //fill the entire canvas
                    context.fillRect(0, 0, this.dimension.width, this.dimension.height);
                }
            });
        </pre>
    </div>
    <br/>
        I let you have a look at the code of "Catch Flowers" game on same repo on GitHub to see a more complete and powerful sky (switch between day and night, ...).

    </p>
</div>

</div>
</div>


</div>
<!-- /WRAPPER -->

<!-- FOOTER -->
<ng-include src="'partials/footer.html'"></ng-include>
<!-- /FOOTER -->

<script type="text/javascript">
    SyntaxHighlighter.all()
</script>


<!-- JAVASCRIPT FILES -->
<script type="text/javascript" src="assets/plugins/jquery-2.0.3.min.js"></script>

<script type="text/javascript" src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>

<script>
    $(document).ready(function() {
        $("body").scrollspy({target : "#side-nav", offset : 50});
    });
</script>

<script type="text/javascript" src="assets/js/scripts.js"></script>

<script type="text/javascript" src="js/googleAnalytics.js"></script>

</body>
</html>